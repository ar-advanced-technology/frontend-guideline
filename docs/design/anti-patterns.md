# アンチパターン

このページでは、設計・実装におけるアンチパターン（NG集）を紹介します。

## クラスの命名

### 文脈に依存したクラス名

クラス名は、**文脈から独立**した、部品としての特徴を捉えた名称にすべきです。

文脈とは「**どこで何のために使われているか、何が入っているか**」です。文脈を元にクラスを付与すると、再利用性が損なわれます。以下は好ましくない例です。

```html
<button class="button-submit">送信する</button>

<table class="news-list-table">...</table>
<table class="table is-news-list">...</table>
```

たとえば一つ目のボタンの例だと、クラス名（`-submit`）が「送信する」という役割に依存しています。そのため、同じ見た目で「送信」ではない役割を持ったボタンには使い回しづらくなっています。

二つ目は、ニュースの一覧を表現するテーブルの例です。ここではクラス名が内容物に依存しています。そのため、ニュース以外のコンテンツが入った同じ見た目のテーブルには再利用できません。

コンポーネントは**視覚的な抽象結果**であって、どこでどのように使われるか、という文脈からは独立しているべきです。あくまで視覚的な特徴からクラスを命名します。

```html
<button class="button is-primary">送信する</button>

<table class="table is-striped">...</table>
```

コンポーネントとしての文脈からの独立性の程度を家具で例えると、「棚」はもちろん、「本棚」もたいてい OK でしょう。ただ「漫画本棚」になると怪しくなってきます。「少年漫画本棚」は NG でしょう。「中野さん家の本棚」はもちろん NG です。

### 色名などをクラス名に用いる

バリエーションクラスに、具体的な属性値をそのまま用いると、変更に弱くなります。

```html
<!-- NG -->
<button clsss="button is-red">ボタン</button>
<button clsss="button is-gray">ボタン</button>
```

上記を例にすると、サイト内で使用するボタンの色が赤ではなくなった場合、HTML と CSS の両方の修正が発生するため、メンテナンス性が低いコードとなります。

クラス名はできるだけ抽象的な意味・役割をもとに命名します。

```html
<!-- OK -->
<button clsss="button is-primary">ボタン</button>
<button clsss="button is-disabled">ボタン</button>
```

「なぜ赤なのか？」を考えて、それを名前にするということです。

以下の例は、さらに分かりやすい NG 例ではないでしょうか。

```html
<!-- NG -->
<button clsss="button is-fontsize-12px">ボタン</button>
```

具体的な属性値は CSS で決めるべきで、HTML 側のクラス名には役割を名前として与えます。

```html
<!-- OK -->
<button clsss="button is-small">ボタン</button>
```

こうすることで、なるべく HTML/CSS の結合を緩くします。

### 略語をクラス名に用いる

```html
<button class="tgt">...</button>
```

略語によって得られる利益はありません。何の略なのか？と考える余計な時間が発生するのみです。

もし単語を短くしたいなら、略するのではなく、同じ意味の別の単語を探しましょう。

## 実装

### 要素へ直接スタイルを当てる

```css
.card span {
  /* NG! */
}
```

HTML 要素へ直接スタイルを当てると、特定の HTML 構造でしか成立しない固定的な、将来の変更に対し脆弱なスタイルとなります。

たとえば、コンポーネント内に要素を追加しにくくなります。上の例で言うと、`.card` の中にもう一つ `<span>` 要素が必要になったときに不要なスタイルが適用されますね。

クラスに対して、スタイルを定義しましょう。

```css
.box .box-text {
  /* OK */
}
```

ただし、例外もあります。まず、`body` 要素などへの基本的なスタイルやリセットスタイルでは、要素に直接スタイルを定義します。

```css
body {
  font-family: ...;
}

ul {
  list-style: none;
}
```

もう一つの例外は、HTML の仕様上、またはコンポーネントの仕様上、必ず特定の要素しか配置されない場合です。

```html
<!-- HTMLの仕様 -->
<figure class="avatar-image">
  <img src="..." alt="..." /><!-- figureの下には必ずimgが入る -->
</figure>

<!-- コンポーネントの仕様 -->
<li class="link-list-item">
  <a href="#">...</a><!-- ここにはリンクしか入らない想定である -->
</li>
```

```css
.link-list-item a {
  /* ... */
}

.avatar-image img {
  /* ... */
}
```

### セレクタを駆使する

```css
.box > p + p {
  /* NG! */
}
```

セレクタを駆使すればするほど、柔軟性に欠ける記述になります。HTML 構造の位置関係を CSS 側から強制するからです。

なるべくクラスに対してスタイルを定義します。

### 詳細度に頼る

CSS には、[詳細度](https://developer.mozilla.org/ja/docs/Web/CSS/Specificity)という重要な言語仕様があります。

詳細度は、デバッグには必要であり、実装には不要なはずの知識です。詳細度に頼ったスタイル定義は変更に対して脆く、予測困難で、すぐに壊れます。

詳細度の調節は小手先のテクニックです。詳細度によってスタイルを制御したくなったら、立ち止まりましょう。そして、根本的な問題に立ち向かい、より健全な方法を模索します。

### `!important` を濫用する

```css
.box {
  background-color: tomato !important; /* NG! */
}
```

`!important` の使用は、つまり詳細度の調節です。さらに、他のスタイルとの協調を阻害します。一部のユーティリティクラスを除き、使用しません。

```css
/* これは許容される例 */
.hidden {
  display: none !important;
}
```

### 過度なネスト（Scss）

```scss
.one {
  .two {
    .three {
      .four {
        .five {
          // ...
        }
      }
    }
  }
}
```

Sass はネストが文法的な特徴であり、便利ですが、過度なネストはまず単純に可読性に欠け、しかも不必要です。そして場合によってコンポーネントの独立性を阻害します。

ネストする機能的、意味的な理由がある場合にのみ、ネストします。

```scss
.component {
  .is-aaa {
    // ...
  }

  .is-bbb {
    // ...
  }

  .component-child {
    // ...
  }
}
```

## 参考

- [エンジニアが受け取って困るCSS](https://www.hypertextcandy.com/troublesome-css-styles-for-developers)
